
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PyLate üê∂">
      
      
        <meta name="author" content="Raphael Sourty">
      
      
        <link rel="canonical" href="https://lightonai.github.io/pylate/documentation/retrieval/">
      
      
        <link rel="prev" href="../datasets/">
      
      
        <link rel="next" href="../evaluation/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.32">
    
    
      
        <title>Retrieval - PyLate</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../css/version-select.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#colbert-based-retrieval-with-plaid" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyLate" class="md-header__button md-logo" aria-label="PyLate" data-md-component="logo">
      
  <img src="../../img/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyLate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Retrieval
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lightonai/pylate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lighton/pylate
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../training/" class="md-tabs__link">
          
  
    
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../models/models/" class="md-tabs__link">
          
  
    
  
  Models

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/overview/" class="md-tabs__link">
          
  
    
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyLate" class="md-nav__button md-logo" aria-label="PyLate" data-md-component="logo">
      
  <img src="../../img/favicon.png" alt="logo">

    </a>
    PyLate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lightonai/pylate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lighton/pylate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Retrieval
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Retrieval
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-plaid-index" class="md-nav__link">
    <span class="md-ellipsis">
      The PLAID Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing" class="md-nav__link">
    <span class="md-ellipsis">
      Indexing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Indexing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-by-step-index-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Index Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persisting-and-re-loading-an-index" class="md-nav__link">
    <span class="md-ellipsis">
      Persisting and Re-loading an Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieval
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Retrieval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-by-step-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Retrieval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features &amp; Optimizations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features & Optimizations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-search-results" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering Search Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compressing-document-embeddings-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Compressing Document Embeddings (Pooling)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-index-updates" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental Index Updates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#indexing-time-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Indexing-Time Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-time-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Search-Time Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stanford-plaid" class="md-nav__link">
    <span class="md-ellipsis">
      Stanford PLAID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reranking" class="md-nav__link">
    <span class="md-ellipsis">
      Reranking
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fastapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../models/models/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Models
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../api/overview/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    API reference
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-plaid-index" class="md-nav__link">
    <span class="md-ellipsis">
      The PLAID Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing" class="md-nav__link">
    <span class="md-ellipsis">
      Indexing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Indexing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-by-step-index-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Index Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persisting-and-re-loading-an-index" class="md-nav__link">
    <span class="md-ellipsis">
      Persisting and Re-loading an Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieval
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Retrieval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-by-step-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Retrieval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features &amp; Optimizations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features & Optimizations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-search-results" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering Search Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compressing-document-embeddings-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Compressing Document Embeddings (Pooling)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-index-updates" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental Index Updates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#indexing-time-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Indexing-Time Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-time-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Search-Time Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stanford-plaid" class="md-nav__link">
    <span class="md-ellipsis">
      Stanford PLAID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reranking" class="md-nav__link">
    <span class="md-ellipsis">
      Reranking
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="colbert-based-retrieval-with-plaid">ColBERT-based Retrieval with PLAID<a class="headerlink" href="#colbert-based-retrieval-with-plaid" title="Permanent link">&para;</a></h1>
<p>PyLate provides a streamlined interface to index and retrieve documents using ColBERT models, powered by our high-performance <strong>PLAID</strong> index.</p>
<h2 id="the-plaid-index">The PLAID Index<a class="headerlink" href="#the-plaid-index" title="Permanent link">&para;</a></h2>
<p>PyLate leverages <a href="https://arxiv.org/abs/2205.09707"><strong>PLAID</strong></a>, a purpose-built index for fast ColBERT retrieval and specifically <strong><a href="https://github.com/lightonai/fast-plaid">FastPLAID</a></strong>, an optimized implementation that delivers significant performance improvements over the original PLAID.</p>
<hr />
<h2 id="indexing">Indexing<a class="headerlink" href="#indexing" title="Permanent link">&para;</a></h2>
<p>The following example demonstrates the end-to-end process of creating a PLAID index from a collection of documents.</p>
<h3 id="step-by-step-index-creation">Step-by-Step Index Creation<a class="headerlink" href="#step-by-step-index-creation" title="Permanent link">&para;</a></h3>
<p>Here's how to load a model, initialize an index, and populate it with your documents.</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pylate</span><span class="w"> </span><span class="kn">import</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">models</span>

<span class="c1"># A sample collection of documents to index</span>
<span class="n">documents_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;doc_001&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_002&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_003&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_004&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_005&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_006&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_007&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_008&quot;</span><span class="p">]</span>

<span class="n">documents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;The Eiffel Tower is a wrought-iron lattice tower on the Champ de Mars in Paris, France. It was designed by Gustave Eiffel and completed in 1889 as the entrance to the 1889 World&#39;s Fair. It is a globally recognized symbol of France and one of the most visited paid monuments in the world. The tower is 330 meters tall and has three levels for visitors.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;The Louvre is the world&#39;s largest art museum and a historic monument in Paris, France. It is located on the Right Bank of the Seine River in the 1st arrondissement. A central landmark of the city, the Louvre is home to some of the most famous works of art, including the Mona Lisa and the Venus de Milo. Its distinctive glass pyramid was added in 1989.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ColBERT is a highly effective neural retrieval model based on late interaction. It was introduced by Omar Khattab and Matei Zaharia. Unlike traditional dense retrieval models that compute a single vector for the entire query and document, ColBERT computes a contextualized embedding for each token of the query and document, and then performs a fast, parallelized late interaction between them.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Paris is known for its cafes, fashion, and the Seine River. The city&#39;s rich history dates back to the Roman era, and it has since become a major center for art, culture, and gastronomy. Landmarks like the Notre-Dame Cathedral, Arc de Triomphe, and the Sacr√©-C≈ìur Basilica add to its architectural beauty.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Deep Learning based information retrieval models have advanced the state of the art in search. These models, often trained on massive datasets, can understand the nuanced semantics of language, moving beyond simple keyword matching. Techniques like Siamese networks, Transformers, and contrastive learning are commonly used to build these powerful retrieval systems.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;The University of Paris, known as the Sorbonne, is one of the world&#39;s oldest universities. It was founded in the mid-12th century and gained a strong reputation for academic excellence. The university has played a pivotal role in the intellectual history of Europe and has been a hub for philosophers, scientists, and writers for centuries.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;The Arc de Triomphe honors those who fought and died for France in the French Revolutionary and Napoleonic Wars. Located at the western end of the Champs-√âlys√©es, it is a key landmark of Paris and a symbol of national pride. The monument stands at the center of Place Charles de Gaulle, a busy roundabout.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;The Seine is a major river in northern France, flowing through Paris and into the English Channel. It has been a vital waterway for commerce and a source of inspiration for countless artists. Many of Paris&#39;s famous monuments and buildings are situated along its banks, including the Notre-Dame Cathedral and the Louvre Museum.&quot;</span>
<span class="p">]</span>

<span class="c1"># --- Step 1: Load the ColBERT Model ---</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ColBERT</span><span class="p">(</span>
    <span class="n">model_name_or_path</span><span class="o">=</span><span class="s2">&quot;lightonai/GTE-ModernColBERT-v1&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># --- Step 2: Initialize the PLAID Index ---</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">PLAID</span><span class="p">(</span>
    <span class="n">index_folder</span><span class="o">=</span><span class="s2">&quot;pylate-colbert-index&quot;</span><span class="p">,</span>
    <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;my_documents&quot;</span><span class="p">,</span>
    <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># --- Step 3: Encode Documents into Embeddings ---</span>
<span class="n">documents_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">documents</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">is_query</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># --- Step 4: Add Document Embeddings to the Index ---</span>
<span class="n">index</span><span class="o">.</span><span class="n">add_documents</span><span class="p">(</span>
    <span class="n">documents_ids</span><span class="o">=</span><span class="n">documents_ids</span><span class="p">,</span>
    <span class="n">documents_embeddings</span><span class="o">=</span><span class="n">documents_embeddings</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indexing complete!&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="persisting-and-re-loading-an-index">Persisting and Re-loading an Index<a class="headerlink" href="#persisting-and-re-loading-an-index" title="Permanent link">&para;</a></h3>
<p>You only need to build the index once. For subsequent uses, you can load the existing index directly from disk. By setting <code>override=False</code>, you ensure that the existing index is preserved and adding documents will append to it rather than replacing it.</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">loaded_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">PLAID</span><span class="p">(</span>
    <span class="n">index_folder</span><span class="o">=</span><span class="s2">&quot;pylate-colbert-index&quot;</span><span class="p">,</span>
    <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;my_documents&quot;</span><span class="p">,</span>
    <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="retrieval">Retrieval<a class="headerlink" href="#retrieval" title="Permanent link">&para;</a></h2>
<p>Once the index is built, you can perform searches. The process involves encoding queries and using the retriever to fetch the top-k most relevant documents.</p>
<h3 id="step-by-step-retrieval">Step-by-Step Retrieval<a class="headerlink" href="#step-by-step-retrieval" title="Permanent link">&para;</a></h3>
<p>This example continues from the previous section, using the index we already created.</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pylate</span><span class="w"> </span><span class="kn">import</span> <span class="n">retrieve</span>

<span class="c1"># Assume &#39;model&#39; and &#39;index&#39; are already loaded from the previous steps.</span>

<span class="c1"># --- Step 1: Initialize the ColBERT Retriever ---</span>
<span class="c1"># The retriever links the model&#39;s scoring logic with the PLAID index.</span>
<span class="n">retriever</span> <span class="o">=</span> <span class="n">retrieve</span><span class="o">.</span><span class="n">ColBERT</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># A list of queries to search for</span>
<span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;monuments in Paris&quot;</span><span class="p">,</span> <span class="s2">&quot;neural retrieval models&quot;</span><span class="p">]</span>

<span class="c1"># --- Step 2: Encode Queries into Embeddings ---</span>
<span class="c1"># Encode the search queries. Note that &#39;is_query=True&#39; is critical here</span>
<span class="c1"># as queries are processed differently from documents.</span>
<span class="n">queries_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">queries</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">is_query</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># --- Step 3: Retrieve Top-k Documents ---</span>
<span class="c1"># The &#39;retrieve&#39; method searches the index and returns ranked results.</span>
<span class="c1"># &#39;k&#39; specifies the maximum number of documents to return for each query.</span>
<span class="n">search_results</span> <span class="o">=</span> <span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">queries_embeddings</span><span class="o">=</span><span class="n">queries_embeddings</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">search_results</span><span class="p">)</span>
</code></pre></div>
<p><strong>Example Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code>[
    [
        {&#39;id&#39;: &#39;doc_002&#39;, &#39;score&#39;: 28.87158203125},
        {&#39;id&#39;: &#39;doc_004&#39;, &#39;score&#39;: 28.73193359375}
    ],
    [
        {&#39;id&#39;: &#39;doc_003&#39;, &#39;score&#39;: 29.3173828125},
        {&#39;id&#39;: &#39;doc_005&#39;, &#39;score&#39;: 29.087890625}
    ]
]
</code></pre></div>
<hr />
<h2 id="advanced-features-optimizations">Advanced Features &amp; Optimizations<a class="headerlink" href="#advanced-features-optimizations" title="Permanent link">&para;</a></h2>
<h3 id="filtering-search-results">Filtering Search Results<a class="headerlink" href="#filtering-search-results" title="Permanent link">&para;</a></h3>
<p>You can constrain a search to a specific subset of document IDs. This is useful for implementing metadata-based filtering (e.g., <code>date &gt; 2024</code>) or searching within a user-defined collection. Filtering can also significantly accelerate searches by reducing the search space.</p>
<details class="info" open="open">
<summary>Document ID Assignment</summary>
<p>The document IDs used in the <code>subset</code> parameter must match the string identifiers provided in <code>documents_ids</code> during the indexing phase.</p>
</details>
<p><strong>Single filter for all queries:</strong></p>
<p>Apply the same list of allowed document IDs to every query in the batch.</p>
<div class="language-python highlight"><pre><span></span><code><span class="c1"># Only documents &quot;doc_001&quot; and &quot;doc_003&quot; are considered for search.</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">queries_embeddings</span><span class="o">=</span><span class="n">queries_embeddings</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;doc_001&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_003&quot;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Different filters for each query:</strong></p>
<p>Provide a list of lists, where each inner list is the specific subset of document IDs for the corresponding query.</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">scores</span> <span class="o">=</span> <span class="n">retriever</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">queries_embeddings</span><span class="o">=</span><span class="n">queries_embeddings</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">subset</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;doc_001&quot;</span><span class="p">,</span> <span class="s2">&quot;doc_002&quot;</span><span class="p">],</span>  <span class="c1"># Filter for the first query</span>
        <span class="p">[</span><span class="s2">&quot;doc_003&quot;</span><span class="p">]</span>             <span class="c1"># Filter for the second query</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="compressing-document-embeddings-pooling">Compressing Document Embeddings (Pooling)<a class="headerlink" href="#compressing-document-embeddings-pooling" title="Permanent link">&para;</a></h3>
<p>To reduce the memory and storage footprint of the index, you can "pool" similar token embeddings within a document. This technique averages token embeddings that are close to each other in the embedding space, effectively compressing the document representation.</p>
<p>You can enable this by setting the <code>pool_factor</code> during document encoding. A <code>pool_factor</code> of 2 will attempt to reduce the number of token embeddings by half.</p>
<details class="tip" open="open">
<summary>Performance vs. Compression</summary>
<p>As detailed in <a href="https://www.answer.ai/posts/colbert-pooling.html">this blog post</a>, a <code>pool_factor</code> of <strong>2</strong> can halve the index size with virtually zero drop in retrieval performance. Higher factors offer more compression at the cost of some accuracy.</p>
<div class="language-python highlight"><pre><span></span><code><span class="c1"># Example of encoding with pooling</span>
<span class="n">documents_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">documents</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">is_query</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pool_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Keep 1/2 of the original tokens</span>
    <span class="n">show_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</details>
<h3 id="incremental-index-updates">Incremental Index Updates<a class="headerlink" href="#incremental-index-updates" title="Permanent link">&para;</a></h3>
<p>The PLAID index computes its k-means centroids based on the initial set of documents provided. You can add new documents to an existing index at any time using <code>add_documents</code>, and <code>override=False</code> but these new documents will be assigned to the <em>original</em> centroids.</p>
<details class="warning" open="open">
<summary>Recommendation for Large-Scale Updates</summary>
<p>While incremental additions are supported, adding a very large volume of new documents that significantly shifts the data distribution may lead to suboptimal clustering. For best performance after massive updates, it is recommended to rebuild the index from scratch.</p>
</details>
<hr />
<h2 id="performance-tuning">Performance Tuning<a class="headerlink" href="#performance-tuning" title="Permanent link">&para;</a></h2>
<p>FastPLAID offers several parameters to fine-tune the trade-off between indexing speed, search speed, and retrieval accuracy.</p>
<h3 id="indexing-time-parameters">Indexing-Time Parameters<a class="headerlink" href="#indexing-time-parameters" title="Permanent link">&para;</a></h3>
<p>These are configured during the <code>indexes.PLAID</code> initialization.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Default</th>
<th style="text-align: left;">Speed Impact</th>
<th style="text-align: left;">Accuracy Impact</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>n_samples_kmeans</code></td>
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;">Lower = faster</td>
<td style="text-align: left;">Lower = less precise</td>
<td style="text-align: left;">Number of embeddings sampled to train k-means centroids. <code>None</code> uses all embeddings.</td>
</tr>
<tr>
<td style="text-align: left;"><code>nbits</code></td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Lower = faster</td>
<td style="text-align: left;">Lower = less precise</td>
<td style="text-align: left;">Bits per sub-vector in Product Quantization. Controls compression level. (Range: 2-8)</td>
</tr>
<tr>
<td style="text-align: left;"><code>kmeans_niters</code></td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Higher = slower</td>
<td style="text-align: left;">Higher = better clusters</td>
<td style="text-align: left;">Number of iterations for the k-means clustering algorithm.</td>
</tr>
</tbody>
</table>
<p><strong>Guidelines:</strong></p>
<ul>
<li><strong>Fastest Indexing:</strong> Use lower <code>n_samples_kmeans</code>, <code>nbits</code> (e.g., 2), and <code>kmeans_niters</code> (e.g., 2).</li>
<li><strong>Highest Quality Index:</strong> Use higher <code>nbits</code> (e.g., 8) and <code>kmeans_niters</code> (e.g., 10+).</li>
</ul>
<h3 id="search-time-parameters">Search-Time Parameters<a class="headerlink" href="#search-time-parameters" title="Permanent link">&para;</a></h3>
<p>These are configured in the <code>retriever.retrieve</code> method.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Default</th>
<th style="text-align: left;">Speed Impact</th>
<th style="text-align: left;">Accuracy Impact</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>n_ivf_probe</code></td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Higher = slower</td>
<td style="text-align: left;">Higher = better recall</td>
<td style="text-align: left;">Number of IVF clusters to visit for each query. A higher value increases the chance of finding relevant documents.</td>
</tr>
<tr>
<td style="text-align: left;"><code>n_full_scores</code></td>
<td style="text-align: left;">8192</td>
<td style="text-align: left;">Higher = slower</td>
<td style="text-align: left;">Higher = better ranking</td>
<td style="text-align: left;">Number of candidate documents to re-rank with the full <code>MaxSim</code> operation.</td>
</tr>
</tbody>
</table>
<p><strong>Guidelines:</strong></p>
<ul>
<li><strong>Fastest Search:</strong> Use a lower <code>n_ivf_probe</code> (e.g., 4) and <code>n_full_scores</code> (e.g., 1024).</li>
<li><strong>Highest Recall:</strong> Use a higher <code>n_ivf_probe</code> (e.g., 16-32) and <code>n_full_scores</code> (e.g., 8192+).</li>
</ul>
<h3 id="stanford-plaid">Stanford PLAID<a class="headerlink" href="#stanford-plaid" title="Permanent link">&para;</a></h3>
<p>Instead of using the default FastPLAID backend, you can opt for the original Stanford PLAID implementation. This is primarily for research or comparison purposes, as it is significantly slower.</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">index</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">PLAID</span><span class="p">(</span>
    <span class="n">index_folder</span><span class="o">=</span><span class="s2">&quot;pylate-colbert-index&quot;</span><span class="p">,</span>
    <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;my_documents&quot;</span><span class="p">,</span>
    <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">use_fast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Use the original Stanford PLAID implementation</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="reranking">Reranking<a class="headerlink" href="#reranking" title="Permanent link">&para;</a></h2>
<p>To perform reranking on top of your first-stage retrieval pipeline without building an index, you can simply use <code>rank.rerank</code> function which takes the queries and documents embeddings along with the documents ids to rerank them:</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pylate</span><span class="w"> </span><span class="kn">import</span> <span class="n">rank</span>

<span class="n">queries</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;query A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;query B&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">documents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;document A&quot;</span><span class="p">,</span> <span class="s2">&quot;document B&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;document 1&quot;</span><span class="p">,</span> <span class="s2">&quot;document C&quot;</span><span class="p">,</span> <span class="s2">&quot;document B&quot;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">documents_ids</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">queries_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">queries</span><span class="p">,</span>
    <span class="n">is_query</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">documents_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">documents</span><span class="p">,</span>
    <span class="n">is_query</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">reranked_documents</span> <span class="o">=</span> <span class="n">rank</span><span class="o">.</span><span class="n">rerank</span><span class="p">(</span>
    <span class="n">documents_ids</span><span class="o">=</span><span class="n">documents_ids</span><span class="p">,</span>
    <span class="n">queries_embeddings</span><span class="o">=</span><span class="n">queries_embeddings</span><span class="p">,</span>
    <span class="n">documents_embeddings</span><span class="o">=</span><span class="n">documents_embeddings</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/lightonai/pylate" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes", "navigation.prune"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.471ce7a9.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3.2/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>